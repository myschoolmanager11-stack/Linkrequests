<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø·Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø§Ù„ÙØ¶Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù…ÙŠ</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" href="favicon.png" type="image/png">
<style>
body {
    margin: 0;
    font-family: "Segoe UI", Tahoma, Arial, sans-serif;
    background: linear-gradient(135deg, #eef2ff, #f8f9ff);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}
.page-wrapper { flex: 1; display: flex; justify-content: center; align-items: center; padding: 20px; }
.card { background: white; width: 100%; max-width: 420px; padding: 25px; border-radius: 14px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
.card h2 { text-align: center; margin-bottom: 10px; }
.subtitle { text-align: center; font-size: 13px; margin-bottom: 20px; color: #555; }
label { font-size: 13px; font-weight: 600; }
select, input, textarea { width: 100%; padding: 10px; margin-top: 5px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #ccc; font-size: 14px; box-sizing: border-box; }
textarea { min-height: 90px; resize: vertical; }
button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: #3f51b5; color: white; font-size: 15px; cursor: pointer; transition: 0.3s; }
button:hover { background: #303f9f; }
#resultMessage { margin-top: 15px; text-align: center; font-size: 14px; font-weight: 600; }
.app-footer { background: #3f51b5; color: white; padding: 8px; overflow: hidden; }
.footer-marquee { white-space: nowrap; animation: move 18s linear infinite; }
@keyframes move { from { transform: translateX(-100%); } to { transform: translateX(100%); } }
@media (max-width: 480px) { .card { padding: 20px; } }
</style>
</head>

<body>
<div class="page-wrapper">
    <div class="card">
        <h2>ğŸŒ Ø·Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø§Ù„ÙØ¶Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù…ÙŠ Ù„Ù„Ù…Ø¤Ø³Ø³Ø©</h2>
        <p class="subtitle">Ø§Ø®ØªØ± Ù…Ø¤Ø³Ø³ØªÙƒ ÙˆØ§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø¥Ù„ÙŠÙƒÙ… ÙÙŠ Ø£Ù‚Ø±Ø¨ Ø§Ù„Ø¢Ø¬Ø§Ù„.</p>

        <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¤Ø³Ø³Ø© -->
        <label>Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</label>
        <select id="institutionSelect">
            <option>Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª...</option>
        </select>

        <!-- Ø§Ù„Ø¨Ø±ÙŠØ¯ -->
        <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input type="email" id="emailInput" placeholder="example@email.com">

        <!-- Ù…Ù„Ø§Ø­Ø¸Ø§Øª -->
        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <textarea id="notesInput" placeholder="ÙŠÙ…ÙƒÙ†Ùƒ ÙƒØªØ§Ø¨Ø© Ø£ÙŠ ØªÙˆØ¶ÙŠØ­ Ù‡Ù†Ø§..."></textarea>

        <!-- Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ -->
        <button onclick="sendRequest()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
        <div id="resultMessage"></div>
    </div>
</div>

<footer class="app-footer">
    <div class="footer-marquee">
        Myschoolmanager Â© 2010 - 2026 | Ø¨Ø±Ù…Ø¬Ø© ÙˆØªØµÙ…ÙŠÙ… Ø¹Ø¨Ø¯Ø§Ù„Ù‚Ø§Ø¯Ø±
    </div>
</footer>

<script>
// Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
const ADMIN_EMAIL = "myschoolmanager11@gmail.com";

// Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
const institutionSelect = document.getElementById("institutionSelect");
const emailInput = document.getElementById("emailInput");
const notesInput = document.getElementById("notesInput");
const resultMessage = document.getElementById("resultMessage");

// Ø±Ø§Ø¨Ø· Google Apps Script Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª
const DRIVE_API_URL = "https://script.google.com/macros/s/AKfycbwDydi0_8toDT0hIgZeCX0zxJmbl1efKR59xJjlE3XuCz7I9UqyVAZioMYQG0b6dCP1ow/exec";

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª
function loadInstitutions() {
    institutionSelect.innerHTML = '<option>Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª...</option>';

    fetch(DRIVE_API_URL + "?action=getInstitutions")
    .then(res => res.json())
    .then(data => {
        if (!data.institutions || data.institutions.length === 0) {
            throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª");
        }

        institutionSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¤Ø³Ø³Ø© --</option>';
        data.institutions.forEach(inst => {
            const option = document.createElement("option");
            option.value = inst;
            option.textContent = inst;
            institutionSelect.appendChild(option);
        });
    })
    .catch(err => {
        console.error(err);
        institutionSelect.innerHTML = '<option>âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª</option>';
    });
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯
function sendRequest() {
    const institution = institutionSelect.value;
    const email = emailInput.value.trim();
    const notes = notesInput.value.trim();

    if (!institution) { showMessage("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¤Ø³Ø³Ø©", "red"); return; }
    if (!validateEmail(email)) { showMessage("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­", "red"); return; }

    const subject = encodeURIComponent("Ø·Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø¨ÙˆØ§Ø¨Ø© - " + institution);
    const body = encodeURIComponent(
        "Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ\n\n" +
        "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ÙØ¶Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù…ÙŠ.\n\n" +
        "Ø§Ù„Ù…Ø¤Ø³Ø³Ø©: " + institution + "\n" +
        "Ø§Ù„Ø¨Ø±ÙŠØ¯: " + email + "\n" +
        "Ù…Ù„Ø§Ø­Ø¸Ø§Øª: " + (notes || "-") + "\n\n" +
        "ØªØ­ÙŠØ§ØªÙ†Ø§."
    );

    // ÙØªØ­ Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
    window.location.href = `mailto:${ADMIN_EMAIL}?subject=${subject}&body=${body}`;
    showMessage("ğŸ“¬ Ø³ÙŠØªÙ… ÙØªØ­ Ø¨Ø±ÙŠØ¯Ùƒ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø©", "green");

    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„
    emailInput.value = "";
    notesInput.value = "";
    institutionSelect.selectedIndex = 0;
}

// ØªØ­Ù‚Ù‚ Ø§Ù„Ø¨Ø±ÙŠØ¯
function validateEmail(email) {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email);
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
function showMessage(msg, color) {
    resultMessage.innerHTML = msg;
    resultMessage.style.color = color;
}

// ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
loadInstitutions();
</script>
</body>
</html>
